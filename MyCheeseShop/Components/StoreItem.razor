@using MyCheeseShop.Model
@using MyCheeseShop.Components
@using MyCheeseShop.Context
@using Model
@inject CheeseProvider CheeseProvider
@inject ShoppingCart ShoppingCart
@inject ProtectedSessionStorage ProtectedSessionStore


<div class="card-group">
    <div class="card m-1">
        <img src="imgs/@Cheese.ImageUrl" class="card-img-top p-2" alt="@Cheese.Name" style="border-radius:15px;">
    <div class="card-body">
     <h5>
       <span class="badge text-bg-primary">@Cheese.Type</span>
       <span class="badge text-bg-success">@Cheese.Strength</span>
     </h5>
     <h5 class="card-title d-flex justify-content-between align-items-center">
       @Cheese.Name
       <span class="badge text-bg-danger">@Cheese.Price</span>
     </h5>


      <p class="card-text">@Cheese.Description</p>

      <div class="d-flex align-items-center">

        <select class="form-select-sm m-2 p-2" style="width: 100px; height: 40px" aria-label="Default select example">
          <option selected>100g</option>
          <option value>200g</option>
          <option value>300g</option>
          <option value>400g</option>
          <option value>500g</option>
         </select>

                <button class="btn btn-primary position-relative" type="submit" onclick="addToCart()">
                    Add to cart
                    <span id="amountBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                        0
                        <span class="visually-hidden">unread messages</span>
                    </span>
                </button>

      </div>

      @* <p class="card-text"><small class="text-body-secondary">Last updated 3 mins ago</small></p> *@
    </div>
  </div>
</div>

<EditForm Model="quantity" OnSubmit="AddToCart">

</EditForm>

@code {

    [Parameter]
    public Cheese Cheese { get; set; }

    private int quantity = 1;

    public async Task AddToCart()
    {
        ShoppingCart.AddItem(Cheese, quantity);
        await ProtectedSessionStore.SetAsync("cart", ShoppingCart.GetItems());
    }

}



